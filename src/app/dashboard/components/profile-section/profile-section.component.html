<div class="profile-section-container">
  <!-- Profile Picture and User Info -->
  <div class="profile-picture-container">
    <div class="profile-picture">
      <img [src]="userProfile?.photoURL || 'assets/default-avatar.png'" alt="Profile Picture">
    </div>
    <button class="edit-picture-button" (click)="fileInput.click()">
      <mat-icon>edit</mat-icon>
    </button>
    <input
      #fileInput
      type="file"
      hidden
      accept="image/*"
      (change)="onFileSelected($event)"
    >
  </div>

  <div class="user-info">
    <h2 class="username">{{ userProfile?.username || 'Username' }}</h2>
    <p class="rank-name">{{ userProfile?.rank?.name || 'Hop Private' }}</p>
  </div>

  <!-- Profile Fields -->
  <div class="profile-fields">
    <div *ngFor="let field of profileFields" class="profile-field">
      <div class="field-content" [class.editing]="editingField === field.key">
        <div class="field-label">{{ field.label }}</div>
        <div class="field-value" *ngIf="editingField !== field.key">
          {{ field.value || 'Not set' }}
          <button *ngIf="field.editable" mat-icon-button (click)="startEditing(field.key)">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <div class="field-edit" *ngIf="editingField === field.key">
          <input
            #editInput
            [value]="field.value || ''"
            (keyup.enter)="onEditField(field.key, editInput.value)"
            (blur)="onEditField(field.key, editInput.value)"
          >
        </div>
      </div>
    </div>
  </div>

  <!-- Rank Card -->
  <div class="rank-card">
    <img [src]="userProfile?.rank?.icon || 'assets/ranks/novice.png'" alt="Rank Icon">
    <div class="rank-info">
      <h3>{{ userProfile?.rank?.name || 'Hop Private' }}</h3>
      <p>Level {{ userProfile?.rank?.level || 2 }}</p>
    </div>
    <mat-progress-bar
      mode="determinate"
      [value]="35"
    ></mat-progress-bar>
    <p class="progress-text">
      35 / 100 points
    </p>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button mat-button (click)="onChangePassword()">
      <mat-icon>lock</mat-icon>
      Change Password
    </button>
    <button mat-button (click)="onRequestNewBeer()">
      <mat-icon>add</mat-icon>
      Request New Beer
    </button>
    <button mat-button (click)="onLogout()">
      <mat-icon>logout</mat-icon>
      Logout
    </button>
  </div>
</div>

